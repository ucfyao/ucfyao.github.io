<!DOCTYPE html>
<html lang="zh-CN,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FF5733">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#FF5733">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yaozihao.com","root":"/","scheme":"Mist","version":"7.8.0","exturl":true,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":"default"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.json"};
  </script>

  <meta name="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
<meta property="og:type" content="website">
<meta property="og:title" content="Zihao">
<meta property="og:url" content="https://yaozihao.com/page/21/index.html">
<meta property="og:site_name" content="Zihao">
<meta property="og:description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Zihao Yao">
<meta property="article:tag" content="PHP, JS, Python, Go, Bitcoin, BlockChain, Quantification, Full stack.">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://yaozihao.com/page/21/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<script async src="/lib/fireworks.js"></script>
  <title>Zihao - Make small but daily progress</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Zihao" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Zihao</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Make small but daily progress</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">64</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">19</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">278</span></a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VjZnlhbw==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/mysql5.6_memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/mysql5.6_memory/" class="post-title-link" itemprop="url">mysql5.6占用内存很大的解决方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-13 14:16:36" itemprop="dateCreated datePublished" datetime="2017-03-13T14:16:36Z">2017-03-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Db/" itemprop="url" rel="index"><span itemprop="name">Db</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>8.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>vps的内存为512M,安装好nginx,php等启动起来,mysql死活启动不起来看了日志只看到对应pid被结束了,后跟踪看发现是内存不足被killed;</p>
<p>调整<code>my.cnf</code>参数,重新配置（系统默认配置太高直接占用400M内存,小玩家玩不起呢）即可<code>performance_schema_max_table_instances=200</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table_definition_cache=200</span><br><span class="line">table_open_cache=128</span><br></pre></td></tr></table></figure>

<p>下面附一个相关的<code>my.cnf</code>配置文件的说明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">port = 3306</span><br><span class="line">socket = /tmp/mysql.sock</span><br><span class="line"> </span><br><span class="line">[mysqld]</span><br><span class="line">port = 3306</span><br><span class="line">socket = /tmp/mysql.sock</span><br><span class="line"> </span><br><span class="line">basedir = /usr/local/mysql</span><br><span class="line">datadir = /data/mysql</span><br><span class="line">pid-file = /data/mysql/mysql.pid</span><br><span class="line">user = mysql</span><br><span class="line">bind-address = 0.0.0.0</span><br><span class="line">server-id = 1 #表示是本机的序号为1,一般来讲就是master的意思</span><br><span class="line"> </span><br><span class="line">skip-name-resolve</span><br><span class="line"># 禁止MySQL对外部连接进行DNS解析，使用这一选项可以消除MySQL进行DNS解析的时间。但需要注意，如果开启该选项，</span><br><span class="line"># 则所有远程主机连接授权都要使用IP地址方式，否则MySQL将无法正常处理连接请求</span><br><span class="line"> </span><br><span class="line">#skip-networking</span><br><span class="line"> </span><br><span class="line">back_log = 600</span><br><span class="line"># MySQL能有的连接数量。当主要MySQL线程在一个很短时间内得到非常多的连接请求，这就起作用，</span><br><span class="line"># 然后主线程花些时间(尽管很短)检查连接并且启动一个新线程。back_log值指出在MySQL暂时停止回答新请求之前的短时间内多少个请求可以被存在堆栈中。</span><br><span class="line"># 如果期望在一个短时间内有很多连接，你需要增加它。也就是说，如果MySQL的连接数据达到max_connections时，新来的请求将会被存在堆栈中，</span><br><span class="line"># 以等待某一连接释放资源，该堆栈的数量即back_log，如果等待连接的数量超过back_log，将不被授予连接资源。</span><br><span class="line"># 另外，这值（back_log）限于您的操作系统对到来的TCP/IP连接的侦听队列的大小。</span><br><span class="line"># 你的操作系统在这个队列大小上有它自己的限制（可以检查你的OS文档找出这个变量的最大值），试图设定back_log高于你的操作系统的限制将是无效的。</span><br><span class="line"> </span><br><span class="line">max_connections = 1000</span><br><span class="line"># MySQL的最大连接数，如果服务器的并发连接请求量比较大，建议调高此值，以增加并行连接数量，当然这建立在机器能支撑的情况下，因为如果连接数越多，介于MySQL会为每个连接提供连接缓冲区，就会开销越多的内存，所以要适当调整该值，不能盲目提高设值。可以过&#x27;conn%&#x27;通配符查看当前状态的连接数量，以定夺该值的大小。</span><br><span class="line"> </span><br><span class="line">max_connect_errors = 6000</span><br><span class="line"># 对于同一主机，如果有超出该参数值个数的中断错误连接，则该主机将被禁止连接。如需对该主机进行解禁，执行：FLUSH HOST。</span><br><span class="line"> </span><br><span class="line">open_files_limit = 65535</span><br><span class="line"># MySQL打开的文件描述符限制，默认最小1024;当open_files_limit没有被配置的时候，比较max_connections*5和ulimit -n的值，哪个大用哪个，</span><br><span class="line"># 当open_file_limit被配置的时候，比较open_files_limit和max_connections*5的值，哪个大用哪个。</span><br><span class="line"> </span><br><span class="line">table_open_cache = 128</span><br><span class="line"># MySQL每打开一个表，都会读入一些数据到table_open_cache缓存中，当MySQL在这个缓存中找不到相应信息时，才会去磁盘上读取。默认值64</span><br><span class="line"># 假定系统有200个并发连接，则需将此参数设置为200*N(N为每个连接所需的文件描述符数目)；</span><br><span class="line"># 当把table_open_cache设置为很大时，如果系统处理不了那么多文件描述符，那么就会出现客户端失效，连接不上</span><br><span class="line"> </span><br><span class="line">max_allowed_packet = 4M</span><br><span class="line"># 接受的数据包大小；增加该变量的值十分安全，这是因为仅当需要时才会分配额外内存。例如，仅当你发出长查询或MySQLd必须返回大的结果行时MySQLd才会分配更多内存。</span><br><span class="line"># 该变量之所以取较小默认值是一种预防措施，以捕获客户端和服务器之间的错误信息包，并确保不会因偶然使用大的信息包而导致内存溢出。</span><br><span class="line"> </span><br><span class="line">binlog_cache_size = 1M</span><br><span class="line"># 一个事务，在没有提交的时候，产生的日志，记录到Cache中；等到事务提交需要提交的时候，则把日志持久化到磁盘。默认binlog_cache_size大小32K</span><br><span class="line"> </span><br><span class="line">max_heap_table_size = 8M</span><br><span class="line"># 定义了用户可以创建的内存表(memory table)的大小。这个值用来计算内存表的最大行数值。这个变量支持动态改变</span><br><span class="line"> </span><br><span class="line">tmp_table_size = 16M</span><br><span class="line"># MySQL的heap（堆积）表缓冲大小。所有联合在一个DML指令内完成，并且大多数联合甚至可以不用临时表即可以完成。</span><br><span class="line"># 大多数临时表是基于内存的(HEAP)表。具有大的记录长度的临时表 (所有列的长度的和)或包含BLOB列的表存储在硬盘上。</span><br><span class="line"># 如果某个内部heap（堆积）表大小超过tmp_table_size，MySQL可以根据需要自动将内存中的heap表改为基于硬盘的MyISAM表。还可以通过设置tmp_table_size选项来增加临时表的大小。也就是说，如果调高该值，MySQL同时将增加heap表的大小，可达到提高联接查询速度的效果</span><br><span class="line"> </span><br><span class="line">read_buffer_size = 2M</span><br><span class="line"># MySQL读入缓冲区大小。对表进行顺序扫描的请求将分配一个读入缓冲区，MySQL会为它分配一段内存缓冲区。read_buffer_size变量控制这一缓冲区的大小。</span><br><span class="line"># 如果对表的顺序扫描请求非常频繁，并且你认为频繁扫描进行得太慢，可以通过增加该变量值以及内存缓冲区大小提高其性能</span><br><span class="line"> </span><br><span class="line">read_rnd_buffer_size = 8M</span><br><span class="line"># MySQL的随机读缓冲区大小。当按任意顺序读取行时(例如，按照排序顺序)，将分配一个随机读缓存区。进行排序查询时，</span><br><span class="line"># MySQL会首先扫描一遍该缓冲，以避免磁盘搜索，提高查询速度，如果需要排序大量数据，可适当调高该值。但MySQL会为每个客户连接发放该缓冲空间，所以应尽量适当设置该值，以避免内存开销过大</span><br><span class="line"> </span><br><span class="line">sort_buffer_size = 8M</span><br><span class="line"># MySQL执行排序使用的缓冲大小。如果想要增加ORDER BY的速度，首先看是否可以让MySQL使用索引而不是额外的排序阶段。</span><br><span class="line"># 如果不能，可以尝试增加sort_buffer_size变量的大小</span><br><span class="line"> </span><br><span class="line">join_buffer_size = 8M</span><br><span class="line"># 联合查询操作所能使用的缓冲区大小，和sort_buffer_size一样，该参数对应的分配内存也是每连接独享</span><br><span class="line"> </span><br><span class="line">thread_cache_size = 8</span><br><span class="line"># 这个值（默认8）表示可以重新利用保存在缓存中线程的数量，当断开连接时如果缓存中还有空间，那么客户端的线程将被放到缓存中，</span><br><span class="line"># 如果线程重新被请求，那么请求将从缓存中读取,如果缓存中是空的或者是新的请求，那么这个线程将被重新创建,如果有很多新的线程，</span><br><span class="line"># 增加这个值可以改善系统性能.通过比较Connections和Threads_created状态的变量，可以看到这个变量的作用。(–&gt;表示要调整的值)</span><br><span class="line"># 根据物理内存设置规则如下：</span><br><span class="line"># 1G  —&gt; 8</span><br><span class="line"># 2G  —&gt; 16</span><br><span class="line"># 3G  —&gt; 32</span><br><span class="line"># 大于3G  —&gt; 64</span><br><span class="line"> </span><br><span class="line">query_cache_size = 8M</span><br><span class="line"># MySQL的查询缓冲大小（从4.0.1开始，MySQL提供了查询缓冲机制）使用查询缓冲，MySQL将SELECT语句和查询结果存放在缓冲区中，</span><br><span class="line"># 今后对于同样的SELECT语句（区分大小写），将直接从缓冲区中读取结果。根据MySQL用户手册，使用查询缓冲最多可以达到238%的效率。</span><br><span class="line"># 通过检查状态值&#x27;Qcache_%&#x27;，可以知道query_cache_size设置是否合理：如果Qcache_lowmem_prunes的值非常大，则表明经常出现缓冲不够的情况，</span><br><span class="line"># 如果Qcache_hits的值也非常大，则表明查询缓冲使用非常频繁，此时需要增加缓冲大小；如果Qcache_hits的值不大，则表明你的查询重复率很低，</span><br><span class="line"># 这种情况下使用查询缓冲反而会影响效率，那么可以考虑不用查询缓冲。此外，在SELECT语句中加入SQL_NO_CACHE可以明确表示不使用查询缓冲</span><br><span class="line"> </span><br><span class="line">query_cache_limit = 2M</span><br><span class="line"># 指定单个查询能够使用的缓冲区大小，默认1M</span><br><span class="line"> </span><br><span class="line">key_buffer_size = 4M</span><br><span class="line"># 指定用于索引的缓冲区大小，增加它可得到更好处理的索引(对所有读和多重写)，到你能负担得起那样多。如果你使它太大，</span><br><span class="line"># 系统将开始换页并且真的变慢了。对于内存在4GB左右的服务器该参数可设置为384M或512M。通过检查状态值Key_read_requests和Key_reads，</span><br><span class="line"># 可以知道key_buffer_size设置是否合理。比例key_reads/key_read_requests应该尽可能的低，</span><br><span class="line"># 至少是1:100，1:1000更好(上述状态值可以使用SHOW STATUS LIKE &#x27;key_read%&#x27;获得)。注意：该参数值设置的过大反而会是服务器整体效率降低</span><br><span class="line"> </span><br><span class="line">ft_min_word_len = 4</span><br><span class="line"># 分词词汇最小长度，默认4</span><br><span class="line"> </span><br><span class="line">transaction_isolation = REPEATABLE-READ</span><br><span class="line"># MySQL支持4种事务隔离级别，他们分别是：</span><br><span class="line"># READ-UNCOMMITTED, READ-COMMITTED, REPEATABLE-READ, SERIALIZABLE.</span><br><span class="line"># 如没有指定，MySQL默认采用的是REPEATABLE-READ，ORACLE默认的是READ-COMMITTED</span><br><span class="line"> </span><br><span class="line">log_bin = mysql-bin</span><br><span class="line">binlog_format = mixed</span><br><span class="line">expire_logs_days = 30 # 超过30天的binlog删除</span><br><span class="line"> </span><br><span class="line">log_error = /data/mysql/mysql-error.log # 错误日志路径</span><br><span class="line">slow_query_log = 1</span><br><span class="line">long_query_time = 1 # 慢查询时间 超过1秒则为慢查询</span><br><span class="line">slow_query_log_file = /data/mysql/mysql-slow.log</span><br><span class="line"> </span><br><span class="line">performance_schema = 0</span><br><span class="line">explicit_defaults_for_timestamp</span><br><span class="line"> </span><br><span class="line"># lower_case_table_names = 1 # 不区分大小写</span><br><span class="line"> </span><br><span class="line">skip-external-locking # MySQL选项以避免外部锁定。该选项默认开启</span><br><span class="line"> </span><br><span class="line">default-storage-engine = InnoDB # 默认存储引擎</span><br><span class="line"> </span><br><span class="line">innodb_file_per_table = 1</span><br><span class="line"># InnoDB为独立表空间模式，每个数据库的每个表都会生成一个数据空间</span><br><span class="line"># 独立表空间优点：</span><br><span class="line"># 1．每个表都有自已独立的表空间。</span><br><span class="line"># 2．每个表的数据和索引都会存在自已的表空间中。</span><br><span class="line"># 3．可以实现单表在不同的数据库中移动。</span><br><span class="line"># 4．空间可以回收（除drop table操作处，表空不能自已回收）</span><br><span class="line"># 缺点：</span><br><span class="line"># 单表增加过大，如超过100G</span><br><span class="line"># 结论：</span><br><span class="line"># 共享表空间在Insert操作上少有优势。其它都没独立表空间表现好。当启用独立表空间时，请合理调整：innodb_open_files</span><br><span class="line"> </span><br><span class="line">innodb_open_files = 500</span><br><span class="line"># 限制Innodb能打开的表的数据，如果库里的表特别多的情况，请增加这个。这个值默认是300</span><br><span class="line"> </span><br><span class="line">innodb_buffer_pool_size = 64M</span><br><span class="line"># InnoDB使用一个缓冲池来保存索引和原始数据, 不像MyISAM.</span><br><span class="line"># 这里你设置越大,你在存取表里面数据时所需要的磁盘I/O越少.</span><br><span class="line"># 在一个独立使用的数据库服务器上,你可以设置这个变量到服务器物理内存大小的80%</span><br><span class="line"># 不要设置过大,否则,由于物理内存的竞争可能导致操作系统的换页颠簸.</span><br><span class="line"># 注意在32位系统上你每个进程可能被限制在 2-3.5G 用户层面内存限制,</span><br><span class="line"># 所以不要设置的太高.</span><br><span class="line"> </span><br><span class="line">innodb_write_io_threads = 4</span><br><span class="line">innodb_read_io_threads = 4</span><br><span class="line"># innodb使用后台线程处理数据页上的读写 I/O(输入输出)请求,根据你的 CPU 核数来更改,默认是4</span><br><span class="line"># 注:这两个参数不支持动态改变,需要把该参数加入到my.cnf里，修改完后重启MySQL服务,允许值的范围从 1-64</span><br><span class="line"> </span><br><span class="line">innodb_thread_concurrency = 0</span><br><span class="line"># 默认设置为 0,表示不限制并发数，这里推荐设置为0，更好去发挥CPU多核处理能力，提高并发量</span><br><span class="line"> </span><br><span class="line">innodb_purge_threads = 1</span><br><span class="line"># InnoDB中的清除操作是一类定期回收无用数据的操作。在之前的几个版本中，清除操作是主线程的一部分，这意味着运行时它可能会堵塞其它的数据库操作。</span><br><span class="line"># 从MySQL5.5.X版本开始，该操作运行于独立的线程中,并支持更多的并发数。用户可通过设置innodb_purge_threads配置参数来选择清除操作是否使用单</span><br><span class="line"># 独线程,默认情况下参数设置为0(不使用单独线程),设置为 1 时表示使用单独的清除线程。建议为1</span><br><span class="line"> </span><br><span class="line">innodb_flush_log_at_trx_commit = 2</span><br><span class="line"># 0：如果innodb_flush_log_at_trx_commit的值为0,log buffer每秒就会被刷写日志文件到磁盘，提交事务的时候不做任何操作（执行是由mysql的master thread线程来执行的。</span><br><span class="line"># 主线程中每秒会将重做日志缓冲写入磁盘的重做日志文件(REDO LOG)中。不论事务是否已经提交）默认的日志文件是ib_logfile0,ib_logfile1</span><br><span class="line"># 1：当设为默认值1的时候，每次提交事务的时候，都会将log buffer刷写到日志。</span><br><span class="line"># 2：如果设为2,每次提交事务都会写日志，但并不会执行刷的操作。每秒定时会刷到日志文件。要注意的是，并不能保证100%每秒一定都会刷到磁盘，这要取决于进程的调度。</span><br><span class="line"># 每次事务提交的时候将数据写入事务日志，而这里的写入仅是调用了文件系统的写入操作，而文件系统是有 缓存的，所以这个写入并不能保证数据已经写入到物理磁盘</span><br><span class="line"># 默认值1是为了保证完整的ACID。当然，你可以将这个配置项设为1以外的值来换取更高的性能，但是在系统崩溃的时候，你将会丢失1秒的数据。</span><br><span class="line"># 设为0的话，mysqld进程崩溃的时候，就会丢失最后1秒的事务。设为2,只有在操作系统崩溃或者断电的时候才会丢失最后1秒的数据。InnoDB在做恢复的时候会忽略这个值。</span><br><span class="line"># 总结</span><br><span class="line"># 设为1当然是最安全的，但性能页是最差的（相对其他两个参数而言，但不是不能接受）。如果对数据一致性和完整性要求不高，完全可以设为2，如果只最求性能，例如高并发写的日志服务器，设为0来获得更高性能</span><br><span class="line"> </span><br><span class="line">innodb_log_buffer_size = 2M</span><br><span class="line"># 此参数确定些日志文件所用的内存大小，以M为单位。缓冲区更大能提高性能，但意外的故障将会丢失数据。MySQL开发人员建议设置为1－8M之间</span><br><span class="line"> </span><br><span class="line">innodb_log_file_size = 32M</span><br><span class="line"># 此参数确定数据日志文件的大小，更大的设置可以提高性能，但也会增加恢复故障数据库所需的时间</span><br><span class="line"> </span><br><span class="line">innodb_log_files_in_group = 3</span><br><span class="line"># 为提高性能，MySQL可以以循环方式将日志文件写到多个文件。推荐设置为3</span><br><span class="line"> </span><br><span class="line">innodb_max_dirty_pages_pct = 90</span><br><span class="line"># innodb主线程刷新缓存池中的数据，使脏数据比例小于90%</span><br><span class="line"> </span><br><span class="line">innodb_lock_wait_timeout = 120</span><br><span class="line"># InnoDB事务在被回滚之前可以等待一个锁定的超时秒数。InnoDB在它自己的锁定表中自动检测事务死锁并且回滚事务。InnoDB用LOCK TABLES语句注意到锁定设置。默认值是50秒</span><br><span class="line"> </span><br><span class="line">bulk_insert_buffer_size = 8M</span><br><span class="line"># 批量插入缓存大小， 这个参数是针对MyISAM存储引擎来说的。适用于在一次性插入100-1000+条记录时， 提高效率。默认值是8M。可以针对数据量的大小，翻倍增加。</span><br><span class="line"> </span><br><span class="line">myisam_sort_buffer_size = 8M</span><br><span class="line"># MyISAM设置恢复表之时使用的缓冲区的尺寸，当在REPAIR TABLE或用CREATE INDEX创建索引或ALTER TABLE过程中排序 MyISAM索引分配的缓冲区</span><br><span class="line"> </span><br><span class="line">myisam_max_sort_file_size = 10G</span><br><span class="line"># 如果临时文件会变得超过索引，不要使用快速排序索引方法来创建一个索引。注释：这个参数以字节的形式给出</span><br><span class="line"> </span><br><span class="line">myisam_repair_threads = 1</span><br><span class="line"># 如果该值大于1，在Repair by sorting过程中并行创建MyISAM表索引(每个索引在自己的线程内) </span><br><span class="line"> </span><br><span class="line">interactive_timeout = 28800</span><br><span class="line"># 服务器关闭交互式连接前等待活动的秒数。交互式客户端定义为在mysql_real_connect()中使用CLIENT_INTERACTIVE选项的客户端。默认值：28800秒（8小时）</span><br><span class="line"> </span><br><span class="line">wait_timeout = 28800</span><br><span class="line"># 服务器关闭非交互连接之前等待活动的秒数。在线程启动时，根据全局wait_timeout值或全局interactive_timeout值初始化会话wait_timeout值，</span><br><span class="line"># 取决于客户端类型(由mysql_real_connect()的连接选项CLIENT_INTERACTIVE定义)。参数默认值：28800秒（8小时）</span><br><span class="line"># MySQL服务器所支持的最大连接数是有上限的，因为每个连接的建立都会消耗内存，因此我们希望客户端在连接到MySQL Server处理完相应的操作后，</span><br><span class="line"># 应该断开连接并释放占用的内存。如果你的MySQL Server有大量的闲置连接，他们不仅会白白消耗内存，而且如果连接一直在累加而不断开，</span><br><span class="line"># 最终肯定会达到MySQL Server的连接上限数，这会报&#x27;too many connections&#x27;的错误。对于wait_timeout的值设定，应该根据系统的运行情况来判断。</span><br><span class="line"># 在系统运行一段时间后，可以通过show processlist命令查看当前系统的连接状态，如果发现有大量的sleep状态的连接进程，则说明该参数设置的过大，</span><br><span class="line"># 可以进行适当的调整小些。要同时设置interactive_timeout和wait_timeout才会生效。</span><br><span class="line"> </span><br><span class="line">[mysqldump]</span><br><span class="line">quick</span><br><span class="line">max_allowed_packet = 16M #服务器发送和接受的最大包长度</span><br><span class="line"> </span><br><span class="line">[myisamchk]</span><br><span class="line">key_buffer_size = 8M</span><br><span class="line">sort_buffer_size = 8M</span><br><span class="line">read_buffer = 4M</span><br><span class="line">write_buffer = 4M</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/git_reset/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/git_reset/" class="post-title-link" itemprop="url">Git恢复版本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-13 10:45:35" itemprop="dateCreated datePublished" datetime="2017-03-13T10:45:35Z">2017-03-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Tool/" itemprop="url" rel="index"><span itemprop="name">Tool</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>395</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// 查看历史记录</span><br><span class="line">git log</span><br><span class="line">// 回滚至某个版本</span><br><span class="line">git reset –hard f093b6ed512f761a346e2e5c0f00230e448c217c</span><br><span class="line">// 回滚</span><br><span class="line">git reset –hard &lt;commit_id&gt;</span><br><span class="line">// 线上回滚</span><br><span class="line">git push origin HEAD –force</span><br><span class="line">根据–soft –mixed –hard，会对working tree和index和HEAD进行重置:</span><br><span class="line">git reset –mixed：</span><br><span class="line">        此为默认方式，不带任何参数的git reset，即时这种方式，它回退到某个版本，只保留源码，回退commit和index信息。</span><br><span class="line">git reset –soft：</span><br><span class="line">         回退到某个版本，只回退了commit信息，不会恢复到index file一级。如果还要提交，直接commit。</span><br><span class="line">git reset –hard：</span><br><span class="line">        彻底回退到某个版本，本地的源码也会变为上一个版本的内容。</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/go_cms_qor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/go_cms_qor/" class="post-title-link" itemprop="url">Go的开源CMS电商框架QOR</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-10 16:31:11" itemprop="dateCreated datePublished" datetime="2017-03-10T16:31:11Z">2017-03-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-28 00:14:23" itemprop="dateModified" datetime="2022-11-28T00:14:23Z">2022-11-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/" itemprop="url" rel="index"><span itemprop="name">Back</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Go语言，兼具语法简单、高并发、高性能的特点，在网络编程领域受到欢迎。 （Go语言的介绍很多，就不再赘述，还不了解Go语言的的朋友可以访问官方网站<span class="exturl" data-url="aHR0cDovL2dvbGFuZy5vcmcv">golang.org<i class="fa fa-external-link-alt"></i></span> 了解详细信息 , 记得先<strong>翻墙</strong>哦） 现在已经有许多大家熟知的开源项目使用Go语言开发，例如</p>
<ul>
<li>Docker，不用多说。</li>
<li>Lantern，一个翻墙软件</li>
<li>Beego和Revel，Go语言写的Web框架</li>
<li>InfluxDB，一个开源分布式的时序、事件和指标数据库</li>
<li>Gogs，搭建自己的Git服务 （以上项目都可以在<span class="exturl" data-url="aHR0cDovL2dpdGh1Yi5jb20v">Github<i class="fa fa-external-link-alt"></i></span>上找到）</li>
</ul>
<p>作为一个长年参与项目工作的程序员，在使用每一种语言工作的过程中都会寻找一些能让重复工作变简单的东西（也可以说<strong>就是懒</strong>），对于Go语言也不例外。 不像PHP、Python可以找到很多CMS项目可以快速的搭建网站，Go语言毕竟还太年轻，虽然有几个很好用的Web框架，但开源的CMS还很少，QOR就是其中之一。 QOR，官方（<span class="exturl" data-url="aHR0cDovL2dldHFvci5jb20v">getqor.com<i class="fa fa-external-link-alt"></i></span>）的定义是:QOR是首个使用Go语言开发的电商系统、CMS的SDK。它是一组用Go编写的库，用于抽象业务应用程序，内容管理系统（CMS）和电子商务系统（EC）所需的通用功能。 根据本人的使用体验，QOR可以看作是PHP中的ThinkPHP，Python中的Django。</p>
<p><img data-src="https://raw.githubusercontent.com/ucfyao/image/img/img/20190422150915.png"></p>
<h3 id="QOR能做什么？"><a href="#QOR能做什么？" class="headerlink" title="QOR能做什么？"></a>QOR能做什么？</h3><p>首先，QOR还不算是CMS，它比起Web框架来说进行了更进一步的封装，将Web开发中常用的部分封装成用起来更简单的库。用它来创建一个基于内容管理的Web应用更加快速简单。</p>
<h4 id="QOR目前可用的有9个部分（另外有3个部分官方标记为Coming-Soon，就不做介绍了）："><a href="#QOR目前可用的有9个部分（另外有3个部分官方标记为Coming-Soon，就不做介绍了）：" class="headerlink" title="QOR目前可用的有9个部分（另外有3个部分官方标记为Coming Soon，就不做介绍了）："></a>QOR目前可用的有9个部分（另外有3个部分官方标记为Coming Soon，就不做介绍了）：</h4><p><strong>Admin</strong>： 快速为您的应用程序生成一个漂亮、可跨平台运行、可配置的管理后台。用过Django的朋友很容易理解，它会生成一个管理ORM的Web界面，搭配Role和Transition可以将它自定义成灵活的管理后台。默认主题是基于谷歌Materials Design的设计理念；可同时兼容PC和移动设备。<strong>通常情况下，QOR的其他所有部分都是围绕Admin工作的。</strong> </p>
<p><strong>Publish</strong> 分别设置预演和正式服务器，使用Publish，内容管理员就能在正式发布之前预览所更新的内容。支持在预演环境下预览，支持管理员对需要发布到正式服务器的类目进行选择。Publish可以配置成指定哪些数据类型需要先经预演服务器，再发布到正式服务器上，哪些数据允许预览或直接发布。结合Role和Transition，系统就能灵活完成内容修改和发布工作。 </p>
<p><strong>Transition</strong> 用Transition来体现业务流程和执行业务规则。定义状态、定义事件、定义状态变化的验证条件。 </p>
<p><strong>Media Library</strong> 支持上传文件至云端或其他位置；支持图像裁剪和调整尺寸。Media Library支持上传和动态调整图片尺寸，且有选项支持将其保存为多种尺寸和分辨率，以适配多种平台。Media Library可以配置成文件保存在文件系统或云存储系统，结合Worker，就能高效管理批量图像的导入和处理。 </p>
<p><strong>Worker</strong> 运行批处理进程，进行批量数据处理或其他耗时的计算。 Worker本质上是长进程的调度程序。Worker提供了一个界面，用于查看一个长进程的进展，中断不完整的长进程，以及查看所有长进程的运行日志。 </p>
<p><strong>Exchange</strong> 应用程序支持数据以CSV或者Excel文件导入和导出，是一个数据文件的出口和入口。目前支持的导入和导出文件格式包括CSV和Excel 电子表格。 </p>
<p><strong>Internationalization(i18n)</strong> 多语言应用程序的翻译工具。 </p>
<p><strong>Localization(l10n)</strong> 在多语言环境中智能管理你的业务对象。Localization用于管理多语言环境下的数据对象。请注意，这和简单的文字翻译（Internationalization包含了这个功能）是不一样的。 </p>
<p><strong>Roles</strong> 给不同的人分配不同角色，不同角色对应不同的权限，灵活实现细粒度的权限控制。Roles 提供了一个健壮、可配置的架构，从而保证角色和权限的粒度控制。Roles还能对特定数据字段进行访问控制。使用Roles就能使某些功能为特定的用户&#x2F;用户类型生效；结合Transition，就能让您的应用程序完美体现组织的工作流程。</p>
<h3 id="QOR应用程序结构"><a href="#QOR应用程序结构" class="headerlink" title="QOR应用程序结构"></a>QOR应用程序结构</h3><p><img data-src="http://upload-images.jianshu.io/upload_images/2855975-a791d2bc2d6f8fd8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240"></p>
<p>QOR的核心是上图中的Engine，它负责管理数据访问和数据处理的接口。 QOR通过插件方式扩展Engine，例如使用worker+exchange实现数据导入&#x2F;导出，或使用media_library实现文件上传。 对于数据库的管理，QOR默认使用GORM，当然也可以用其他ORM库替换默认的GORM。 QOR将前端完全交给开发人员，没有对前端进行任何管理，让开发人员可以自由灵活的开发前端部分。</p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>QOR虽然目前Github上Star不到2000，Fork也只是接近300，但QOR的模式是挺不错的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/go_install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/go_install/" class="post-title-link" itemprop="url">GoLang安装方式</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-08 18:55:56" itemprop="dateCreated datePublished" datetime="2017-03-08T18:55:56Z">2017-03-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-28 00:14:23" itemprop="dateModified" datetime="2022-11-28T00:14:23Z">2022-11-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/" itemprop="url" rel="index"><span itemprop="name">Back</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>学习一下Go语言。学习之前，首先要搭建一下Go语言的开发环境，这篇文章主要介绍一下搭建环境的过程。</p>
<p>一、安装Go语言依赖包</p>
<p>Go语言部分功能是用C语言开发的，所以安装Go之前需要安装gcc，make等依赖，ubuntu下的安装命令如下：</p>
<p>sudo apt-get install bison ed gawk gcc libc6-dev make<br>二、获取Go源码</p>
<p>成功安装了Go语言的依赖之后，就需要下载Go语言的源码包，方法比较多：可以通过hg拷贝源码，也可以到官网上直接下载对应的源码包</p>
<p>1、使用hg拷贝</p>
<p>这种方式需要先安装Mercurial，Mercurial是类似git的版本管理系统，简称hg(水银)，安装命令如下：</p>
<p>sudo apt-get install python-setuptools<br>sudo apt-get install python-dev<br>sudo apt-get install build-essential<br>sudo apt-get install mercurial<br>安装完成之后，通过下面的命令拷贝代码：</p>
<p>cd ~&#x2F;<br>hg clone -r release <span class="exturl" data-url="aHR0cHM6Ly9nby5nb29nbGVjb2RlLmNvbS9oZy8=">https://go.googlecode.com/hg/<i class="fa fa-external-link-alt"></i></span> go<br>2、直接下载</p>
<p>Go语言官方下载地址：官方</p>
<p>由于被墙的原因，官方下载地址很难正常打开，所以我将自己下载的Ubuntu 32位的源码包放在了百度网盘上，安装环境和我一样的同学可以直接下载这个：百度网盘</p>
<p>下载之后将压缩包解压到HOME目录下。</p>
<p>三、配置Go环境变量</p>
<p>在编译安装之前，还需要设置Go语言的环境变量，在Ubuntu下的配置方法如下：</p>
<p>1、打开HOME目录下的.bashrc文件</p>
<p>vim ~&#x2F;.bashrc<br>2、在文件的最后添加以下内容</p>
<p>export GOROOT&#x3D;$HOME&#x2F;go<br>export GOBIN&#x3D;$GOROOT&#x2F;bin<br>export GOARCH&#x3D;386<br>export GOOS&#x3D;linux<br>export PATH&#x3D;$GOROOT&#x2F;bin:$PATH<br>export GOPATH&#x3D;$HOME&#x2F;workspace&#x2F;Go<br>3、保存设置并运行命令使其生效</p>
<p>source ~&#x2F;.bashrc<br>四、编译Go源码包</p>
<p>以上步骤完成之后就可以执行编译脚本了，编译Go语言的命令如下：</p>
<p>cd $GOROOT&#x2F;src<br>.&#x2F;all.bash<br>编译会执行大概10分钟的时间，当你看到以下信息的时候，就表示安装成功了：</p>
<p>ALL TESTS PASSED</p>
<hr>
<p>Installed Go for linux&#x2F;386 in &#x2F;home&#x2F;wuxianglong&#x2F;go.<br>Installed commands in &#x2F;home&#x2F;wuxianglong&#x2F;go&#x2F;bin.<br>五、Hello World!</p>
<p>在学习一门新的语言时，我们写的第一行代码一般是Hello World，这里也不例外。在执行完上述的步骤之后，你可以在命令行输入 go 并回车，如果出现以下内容，则说明你已经安装成功了：</p>
<p>Go is a tool for managing Go source code.</p>
<p>Usage:</p>
<pre><code>go command [arguments]
</code></pre>
<p>The commands are:</p>
<pre><code>build       compile packages and dependencies
clean       remove object files
env         print Go environment information
fix         run go tool fix on packages
fmt         run gofmt on package sources
get         download and install packages and dependencies
install     compile and install packages and dependencies
list        list packages
run         compile and run Go program
test        test packages
tool        run specified go tool
version     print Go version
vet         run go tool vet on packages
</code></pre>
<p>Use “go help [command]” for more information about a command.</p>
<p>Additional help topics:</p>
<pre><code>c           calling between Go and C
filetype    file types
gopath      GOPATH environment variable
importpath  import path syntax
packages    description of package lists
testflag    description of testing flags
testfunc    description of testing functions
</code></pre>
<p>Use “go help [topic]” for more information about that topic.<br>之后，可以写一个Hello World程序，代码如下：</p>
<p>package main</p>
<p>import “fmt”</p>
<p>func main() {<br>    fmt.Printf(“Hello World!\n”)<br>}<br>将上面的代码保存在文件hello.go中，然后在命令行执行：</p>
<p>go run hello.go</p>
<h1 id="输出结果：Hello-World"><a href="#输出结果：Hello-World" class="headerlink" title="输出结果：Hello World!"></a>输出结果：Hello World!</h1><p>OK！Go语言的开发环境已经安装成功了！</p>
<p>六、其他安装方式</p>
<p>以上介绍的Go语言安装方法是通过编译源码安装的，其实在Ubuntu下也可以通过apt-get方式安装，安装命令如下：</p>
<p>sudo apt-get install golang<br>如果上面的命令安装出错的话，可以尝试一下下面的命令：</p>
<p>sudo add-apt-repository ppa:gophers&#x2F;go<br>sudo apt-get update<br>sudo apt-get install golang-stable</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/linux_go_gvm_install/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/linux_go_gvm_install/" class="post-title-link" itemprop="url">Linux 使用GVM安装并管理Go版本</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-03-08 18:47:39" itemprop="dateCreated datePublished" datetime="2017-03-08T18:47:39Z">2017-03-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-28 00:14:23" itemprop="dateModified" datetime="2022-11-28T00:14:23Z">2022-11-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/" itemprop="url" rel="index"><span itemprop="name">Back</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Back/go/" itemprop="url" rel="index"><span itemprop="name">go</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>455</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="安装GVM"><a href="#安装GVM" class="headerlink" title="安装GVM"></a>安装GVM</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ zsh &lt; &lt;(curl -s -S -L https://raw.githubusercontent.com/moovweb/gvm/master/binscripts/gvm-installer)</span><br></pre></td></tr></table></figure>

<h2 id="使用GVM"><a href="#使用GVM" class="headerlink" title="使用GVM"></a>使用GVM</h2><h3 id="查看当前机器的Go环境"><a href="#查看当前机器的Go环境" class="headerlink" title="查看当前机器的Go环境"></a>查看当前机器的Go环境</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ gvm list </span><br><span class="line">gvm gos (installed) </span><br><span class="line">system</span><br></pre></td></tr></table></figure>

<p>这里只显示了一个system，这是系统原来安装的一个Go版本。</p>
<h3 id="查看所有可安装的Go版本"><a href="#查看所有可安装的Go版本" class="headerlink" title="查看所有可安装的Go版本"></a>查看所有可安装的Go版本</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ gvm listall </span><br></pre></td></tr></table></figure>

<h3 id="安装-Go"><a href="#安装-Go" class="headerlink" title="安装 Go"></a>安装 Go</h3><p>这里安装两个版本的Go，后面切换用。 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gvm install go1.5 -B</span><br><span class="line">$ gvm install go1.6 -B</span><br></pre></td></tr></table></figure>

<p>安装完成后，查看一下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ gvm list</span><br><span class="line"></span><br><span class="line">gvm gos (installed)</span><br><span class="line"></span><br><span class="line">   go1.5</span><br><span class="line">   go1.6</span><br><span class="line">   system</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="切换Go版本"><a href="#切换Go版本" class="headerlink" title="切换Go版本"></a>切换Go版本</h3><ul>
<li>使用Go1.5</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gvm use go1.5</span><br><span class="line"></span><br><span class="line">$ go version</span><br><span class="line">go version go1.5 linux/amd64</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<ul>
<li>使用Go1.6</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gvm use go1.6</span><br><span class="line"></span><br><span class="line">$ go version</span><br><span class="line">go version go1.6 linux/amd64</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/js_dom/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/js_dom/" class="post-title-link" itemprop="url">DOM是什么</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-23 23:03:32" itemprop="dateCreated datePublished" datetime="2017-02-23T23:03:32Z">2017-02-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-28 00:14:23" itemprop="dateModified" datetime="2022-11-28T00:14:23Z">2022-11-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Front/" itemprop="url" rel="index"><span itemprop="name">Front</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Front/css/" itemprop="url" rel="index"><span itemprop="name">css</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>882</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="一、DOM全称"><a href="#一、DOM全称" class="headerlink" title="一、DOM全称"></a>一、DOM全称</h3><p>文档对象模型（Document Object Model）</p>
<h3 id="二、DOM是什么"><a href="#二、DOM是什么" class="headerlink" title="二、DOM是什么"></a>二、DOM是什么</h3><p>DOM就是一个编程接口，就是一套API。</p>
<p>DOM是针对HTML文档、XML等文档的一套API。就类似于JDBC是针对数据库的一套API一样。</p>
<h3 id="三、DOM的用途"><a href="#三、DOM的用途" class="headerlink" title="三、DOM的用途"></a>三、DOM的用途</h3><p>DOM 是用来访问或操作HTML文档、XHTML文档、XML文档中的节点元素。</p>
<p>现在基本上所有的浏览器都都执行了W3C发布的DOM规范，所以在浏览器上就可以用DOM的这些API。</p>
<h3 id="四、DOM与其他技术的联系"><a href="#四、DOM与其他技术的联系" class="headerlink" title="四、DOM与其他技术的联系"></a>四、DOM与其他技术的联系</h3><p>JavaScript 可以通过 DOM 来访问和操作HTML文档所有的元素。</p>
<p>JavaScript是一种脚本语言，DOM是用来获得和操作HTML文档的节点属性。JavaScript通常是通过DOM来获得和操作HTML属性的。这就是二者的区别与联系。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    function test()&#123;</span><br><span class="line">        window.alert(“成功。”);</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;input type=button value=“提交” onclick=“test()”&gt;</span><br></pre></td></tr></table></figure>

<p>把上述代码复制到一个文件里，改成.html扩展名后，打开此html文档，点击”提交”按钮会弹出”成功”对话框。</p>
<p>其中：</p>
<p>第1，2，4，5行是JavaScript代码。</p>
<p>第3行是DOM代码（此行一定不要混淆成是JavaScript代码）。这就是JavaScript调用DOM的例子。</p>
<p>第6行是html代码。</p>
<h3 id="五、DOM详细说明"><a href="#五、DOM详细说明" class="headerlink" title="五、DOM详细说明"></a>五、DOM详细说明</h3><p>HTML文档是树状结构，根为<HTML>；DOM也是树状结构，根为window或document对象。</p>
<p>所以DOM就可以把HTML以树状的形式呈现出来。</p>
<h3 id="六、DOM的分类"><a href="#六、DOM的分类" class="headerlink" title="六、DOM的分类"></a>六、DOM的分类</h3><p>核心 DOM：定义了一套标准的可以针对任何文档的对象。</p>
<p>HTML DOM：针对HTML文档的DOM。</p>
<p>XML DOM：针对XML文档的DOM。</p>
<h3 id="七、DOM的级别Level"><a href="#七、DOM的级别Level" class="headerlink" title="七、DOM的级别Level"></a>七、DOM的级别Level</h3><p>DOM0：不是W3C规范。</p>
<p>DOM1：开始是W3C规范。专注于HTML文档和XML文档。</p>
<p>DOM2：对DOM1增加了样式表对象模型</p>
<p>DOM3：对DOM2增加了内容模型 (DTD 、Schemas) 和文档验证。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/linux_scp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/linux_scp/" class="post-title-link" itemprop="url">Linux命令大全之scp命令详解(复制文件和目录远程传输)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-22 10:45:50" itemprop="dateCreated datePublished" datetime="2017-02-22T10:45:50Z">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>2 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="常用的情况"><a href="#常用的情况" class="headerlink" title="常用的情况"></a>常用的情况</h2><p>两台机器IP分别为：A.104.238.161.75，B.43.224.34.73。</p>
<p>在A服务器上操作，将B服务器上&#x2F;home&#x2F;zihao&#x2F;目录下所有的文件全部复制到本地的<code>/root</code>目录下，<br>命令为：<code>scp -r root@43.224.34.73:/home/zihao/ /root</code>。</p>
<p>具体过程为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@XX ~]# scp -r root@43.224.34.73:/home/zihao /root</span><br><span class="line">root@43.224.34.73’s password:</span><br><span class="line">k.zip 100% 176 0.2KB/s 00:00</span><br><span class="line">.bash_history 100% 32 0.0KB/s 00:00</span><br></pre></td></tr></table></figure>
<p>在A服务器上将<code>/root/zihao</code>目录下所有的文件传输到B的<code>/home/zihao/cpfile</code>目录下，</p>
<p>命令为：<code>scp -r /root/zihao root@43.224.34.73:/home/zihao/cpfile</code>。</p>
<p>具体过称为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@XX zihao]# scp -r /root/zihao root@43.224.34.73:/home/zihao/cpfile</span><br><span class="line">root@43.224.34.73’s password:</span><br><span class="line">k.zip 100% 176 0.2KB/s 00:00</span><br><span class="line">.bashrc 100% 231 0.2KB/s 00:00</span><br></pre></td></tr></table></figure>
<p>scp在夸机器复制的时候为了提高数据的安全性，使用了ssh连接和加密方式，如果机器之间配置了ssh免密码登录，那在使用scp的时候密码都不用输入。</p>
<p>加端口号和sshkey的方式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P 65499 -i ~/.ssh/test ~/Downloads/beta.zip ubuntu@123.200.00.100:~/</span><br></pre></td></tr></table></figure>

<h2 id="命令详解："><a href="#命令详解：" class="headerlink" title="命令详解："></a>命令详解：</h2><p>scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。另外，scp还非常不占资源，不会提高多少系统负荷，在这一点上，rsync就远远不及它了。虽然 rsync比scp会快一点，但当小文件众多的情况下，rsync会导致硬盘I&#x2F;O非常高，而scp基本不影响系统正常使用。</p>
<h3 id="命令格式："><a href="#命令格式：" class="headerlink" title="命令格式："></a>命令格式：</h3><p>scp [参数] [原路径] [目标路径]</p>
<h3 id="命令功能："><a href="#命令功能：" class="headerlink" title="命令功能："></a>命令功能：</h3><p>scp是 secure copy的缩写, scp是linux系统下基于ssh登陆进行安全的远程文件拷贝命令。linux的scp命令可以在linux服务器之间复制文件和目录。</p>
<h3 id="命令参数："><a href="#命令参数：" class="headerlink" title="命令参数："></a>命令参数：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">-1 强制scp命令使用协议ssh1</span><br><span class="line"></span><br><span class="line">-2 强制scp命令使用协议ssh2</span><br><span class="line"></span><br><span class="line">-4 强制scp命令只使用IPv4寻址</span><br><span class="line"></span><br><span class="line">-6 强制scp命令只使用IPv6寻址</span><br><span class="line"></span><br><span class="line">-B 使用批处理模式（传输过程中不询问传输口令或短语）</span><br><span class="line"></span><br><span class="line">-C 允许压缩。（将-C标志传递给ssh，从而打开压缩功能）</span><br><span class="line"></span><br><span class="line">-p 保留原文件的修改时间，访问时间和访问权限。</span><br><span class="line"></span><br><span class="line">-q 不显示传输进度条。</span><br><span class="line"></span><br><span class="line">-r 递归复制整个目录。</span><br><span class="line"></span><br><span class="line">-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。</span><br><span class="line"></span><br><span class="line">-c cipher 以cipher将数据传输进行加密，这个选项将直接传递给ssh。</span><br><span class="line"></span><br><span class="line">-F ssh_config 指定一个替代的ssh配置文件，此参数直接传递给ssh。</span><br><span class="line"></span><br><span class="line">-i identity_file 从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。</span><br><span class="line"></span><br><span class="line">-l limit 限定用户所能使用的带宽，以Kbit/s为单位。</span><br><span class="line"></span><br><span class="line">-o ssh_option 如果习惯于使用ssh_config(5)中的参数传递方式，</span><br><span class="line"></span><br><span class="line">-P port 注意是大写的P, port是指定数据传输用到的端口号</span><br><span class="line"></span><br><span class="line">-S program 指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项。</span><br></pre></td></tr></table></figure>
<h3 id="使用实例："><a href="#使用实例：" class="headerlink" title="使用实例："></a>使用实例：</h3><p>从本地服务器复制到远程服务器：</p>
<h4 id="复制文件："><a href="#复制文件：" class="headerlink" title="复制文件："></a>复制文件：</h4><p>命令格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp local_file remote_username@remote_ip:remote_folder</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp local_file remote_username@remote_ip:remote_file</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp local_file remote_ip:remote_folder</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp local_file remote_ip:remote_file</span><br></pre></td></tr></table></figure>
<p>第1,2个指定了用户名，命令执行后需要输入用户密码，第1个仅指定了远程的目录，文件名字不变，第2个指定了文件名</p>
<p>第3,4个没有指定用户名，命令执行后需要输入用户名和密码，第3个仅指定了远程的目录，文件名字不变，第4个指定了文件名</p>
<h4 id="复制目录："><a href="#复制目录：" class="headerlink" title="复制目录："></a>复制目录：</h4><p>命令格式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r local_folder remote_username@remote_ip:remote_folder</span><br></pre></td></tr></table></figure>
<p>或者</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r local_folder remote_ip:remote_folder</span><br></pre></td></tr></table></figure>
<p>第1个指定了用户名，命令执行后需要输入用户密码；</p>
<p>第2个没有指定用户名，命令执行后需要输入用户名和密码；</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/mysql_mysqldump/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/mysql_mysqldump/" class="post-title-link" itemprop="url">mysql导入导出sql文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-22 10:33:43" itemprop="dateCreated datePublished" datetime="2017-02-22T10:33:43Z">2017-02-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Db/" itemprop="url" rel="index"><span itemprop="name">Db</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="导出"><a href="#导出" class="headerlink" title="导出"></a>导出</h3><h4 id="导出全库备份到本地的目录"><a href="#导出全库备份到本地的目录" class="headerlink" title="导出全库备份到本地的目录"></a>导出全库备份到本地的目录</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u$USER -p$PASSWD -h127.0.0.1 -P3306 --routines --default-character-set=utf8 --lock-all-tables --add-drop-database -A &gt; db.all.sql</span><br></pre></td></tr></table></figure>

<h4 id="导出指定库到本地的目录"><a href="#导出指定库到本地的目录" class="headerlink" title="导出指定库到本地的目录"></a>导出指定库到本地的目录</h4><p>例如mysql库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u$USER -p$PASSWD -h127.0.0.1 -P3306 --routines --default-character-set=utf8 --databases mysql &gt; db.sql</span><br></pre></td></tr></table></figure>

<h4 id="导出某个库的表到本地的目录"><a href="#导出某个库的表到本地的目录" class="headerlink" title="导出某个库的表到本地的目录"></a>导出某个库的表到本地的目录</h4><p>例如mysql库的user表</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u$USER -p$PASSWD -h127.0.0.1 -P3306 --routines --default-character-set=utf8 --tables mysql user&gt; db.table.sql</span><br></pre></td></tr></table></figure>

<h4 id="导出指定库的表-仅数据-到本地的目录"><a href="#导出指定库的表-仅数据-到本地的目录" class="headerlink" title="导出指定库的表(仅数据)到本地的目录"></a>导出指定库的表(仅数据)到本地的目录</h4><p>例如mysql库的user表,带过滤条件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u$USER -p$PASSWD -h127.0.0.1 -P3306 --routines --default-character-set=utf8 --no-create-db --no-create-info --tables mysql user --where=&quot;host=&#x27;localhost&#x27;&quot;&gt; db.table.sql</span><br></pre></td></tr></table></figure>

<h4 id="导出某个库的所有表结构"><a href="#导出某个库的所有表结构" class="headerlink" title="导出某个库的所有表结构"></a>导出某个库的所有表结构</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u$USER -p$PASSWD -h127.0.0.1 -P3306 --routines --default-character-set=utf8 --no-data --databases mysql &gt; db.nodata.sql</span><br></pre></td></tr></table></figure>

<h4 id="导出某个查询sql的数据为txt格式文件到本地的目录"><a href="#导出某个查询sql的数据为txt格式文件到本地的目录" class="headerlink" title="导出某个查询sql的数据为txt格式文件到本地的目录"></a>导出某个查询sql的数据为txt格式文件到本地的目录</h4><p>(各数据值之间用”制表符”分隔)<br>例如sql为’select user,host,password from mysql.user;’</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8 --skip-column-names -B -e &#x27;select user,host,password from mysql.user;&#x27; &gt; mysql_user.txt</span><br></pre></td></tr></table></figure>

<h4 id="导出某个查询sql的数据为txt格式文件到MySQL服务器"><a href="#导出某个查询sql的数据为txt格式文件到MySQL服务器" class="headerlink" title="导出某个查询sql的数据为txt格式文件到MySQL服务器"></a>导出某个查询sql的数据为txt格式文件到MySQL服务器</h4><p>登录MySQL，将默认的制表符换成逗号(适应csv格式文件)，指定的路径，mysql要有写的权限。最好用tmp目录,文件用完之后,再删除!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT user,host,password FROM mysql.user INTO OUTFILE &#x27;/tmp/mysql_user.csv&#x27; FIELDS TERMINATED BY &#x27;,&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="导入"><a href="#导入" class="headerlink" title="导入"></a>导入</h3><h4 id="恢复全库数据到MySQL"><a href="#恢复全库数据到MySQL" class="headerlink" title="恢复全库数据到MySQL"></a>恢复全库数据到MySQL</h4><p>因为包含mysql库的权限表,导入完成需要执行<code>FLUSH PRIVILEGES;</code>命令</p>
<p>第一种方法:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8 &lt; db.all.sql</span><br></pre></td></tr></table></figure>

<p>第二种方法:<br>登录MySQL,执行source命令,后面的文件名要用绝对路径.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; source /tmp/db.all.sql;</span><br></pre></td></tr></table></figure>

<h4 id="恢复某个库的数据-mysql库的user表"><a href="#恢复某个库的数据-mysql库的user表" class="headerlink" title="恢复某个库的数据(mysql库的user表)"></a>恢复某个库的数据(mysql库的user表)</h4><p>第一种方法:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8 mysql &lt; db.table.sql</span><br></pre></td></tr></table></figure>

<p>第二种方法:<br>登录MySQL,执行source命令,后面的文件名要用绝对路径.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8</span><br><span class="line">.......</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; source /tmp/db.table.sql;</span><br></pre></td></tr></table></figure>

<h4 id="恢复MySQL服务器上面的txt格式文件"><a href="#恢复MySQL服务器上面的txt格式文件" class="headerlink" title="恢复MySQL服务器上面的txt格式文件"></a>恢复MySQL服务器上面的txt格式文件</h4><p>需要FILE权限,各数据值之间用”制表符”分隔</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8</span><br><span class="line">......</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; LOAD DATA INFILE &#x27;/tmp/mysql_user.txt&#x27; INTO TABLE user ;</span><br></pre></td></tr></table></figure>
<h4 id="恢复MySQL服务器上面的csv格式文件"><a href="#恢复MySQL服务器上面的csv格式文件" class="headerlink" title="恢复MySQL服务器上面的csv格式文件"></a>恢复MySQL服务器上面的csv格式文件</h4><p>需要FILE权限,各数据值之间用”逗号”分隔</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8</span><br><span class="line">......</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; LOAD DATA INFILE &#x27;/tmp/mysql_user.csv&#x27; INTO TABLE user FIELDS TERMINATED BY &#x27;,&#x27;;</span><br></pre></td></tr></table></figure>

<h4 id="恢复本地的txt或csv文件到MySQL"><a href="#恢复本地的txt或csv文件到MySQL" class="headerlink" title="恢复本地的txt或csv文件到MySQL"></a>恢复本地的txt或csv文件到MySQL</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql -u$USER -p$PASSWD -h127.0.0.1 -P3306 --default-character-set=utf8</span><br><span class="line">......</span><br><span class="line">mysql&gt; use mysql;</span><br><span class="line"># txt</span><br><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &#x27;/tmp/mysql_user.csv&#x27; INTO TABLE user;</span><br><span class="line"># csv</span><br><span class="line">mysql&gt; LOAD DATA LOCAL INFILE &#x27;/tmp/mysql_user.csv&#x27; INTO TABLE user FIELDS TERMINATED BY &#x27;,&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h3><p>关于MySQL连接</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">-u$USER 用户名</span><br><span class="line">-p$PASSWD 密码</span><br><span class="line">-h127.0.0.1 如果连接远程服务器,请用对应的主机名或者IP地址替换</span><br><span class="line">-P3306 端口</span><br><span class="line">–default-character-set=utf8 指定字符集</span><br><span class="line">关于mysql参数</span><br><span class="line">–skip-column-names 不显示数据列的名字</span><br><span class="line">-B 以批处理的方式运行mysql程序.查询结果将显示为制表符间隔格式.</span><br><span class="line">-e 执行命令后,退出</span><br><span class="line">关于mysqldump参数</span><br><span class="line">-A 全库备份</span><br><span class="line">–routines 备份存储过程和函数</span><br><span class="line">–default-character-set=utf8 设置字符集</span><br><span class="line">–lock-all-tables 全局一致性锁</span><br><span class="line">–add-drop-database 在每次执行建表语句之前,先执行DROP TABLE IF EXIST语句</span><br><span class="line">–no-create-db 不输出CREATE DATABASE语句</span><br><span class="line">–no-create-info 不输出CREATE TABLE语句</span><br><span class="line">–databases 将后面的参数都解析为库名</span><br><span class="line">–tables 第一个参数为库名 后续为表名</span><br></pre></td></tr></table></figure>

<h3 id="关于LOAD-DATA语法"><a href="#关于LOAD-DATA语法" class="headerlink" title="关于LOAD DATA语法"></a>关于LOAD DATA语法</h3><p>如果LOAD DATA语句不带LOCAL关键字,就在MySQL的服务器上直接读取文件,且要具有FILE权限。<br>如果带LOCAL关键字,就在客户端本地读取数据文件,通过网络传到MySQL。<br>LOAD DATA语句,同样被记录到binlog,不过是内部的机制。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/origin_cross_domain/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/origin_cross_domain/" class="post-title-link" itemprop="url">同源策略和跨域访问</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-20 16:21:37" itemprop="dateCreated datePublished" datetime="2017-02-20T16:21:37Z">2017-02-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web/Theory/" itemprop="url" rel="index"><span itemprop="name">Theory</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>7.5k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>7 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="什么是同源策略"><a href="#什么是同源策略" class="headerlink" title="什么是同源策略"></a>什么是同源策略</h2><p>理解跨域首先必须要了解同源策略。同源策略是浏览器上为安全性考虑实施的非常重要的安全策略。</p>
<h3 id="何谓同源"><a href="#何谓同源" class="headerlink" title="何谓同源:"></a>何谓同源:</h3><p>URL由协议、域名、端口和路径组成，如果两个URL的协议、域名和端口相同，则表示他们同源。</p>
<h3 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略:"></a>同源策略:</h3><p>浏览器的同源策略，限制了来自不同源的”document”或脚本，对当前”document”读取或设置某些属性。<br>从一个域上加载的脚本不允许访问另外一个域的文档属性。</p>
<p>举个例子：<br>比如一个恶意网站的页面通过iframe嵌入了银行的登录页面（二者不同源），如果没有同源限制，恶意网页上的javascript脚本就可以在用户登录银行的时候获取用户名和密码。</p>
<p>在浏览器中，<code>&lt;script&gt;、&lt;img&gt;、&lt;iframe&gt;、&lt;link&gt;</code>等标签都可以加载跨域资源，而不受同源限制，但浏览器限制了JavaScript的权限使其不能读、写加载的内容。<br>另外同源策略只对网页的HTML文档做了限制，对加载的其他静态资源如javascript、css、图片等仍然认为属于同源。</p>
<p>代码示例（<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwLyVFNSU5MiU4Q2h0dHA6Ly9sb2NhbGhvc3Q6ODA4MSVFNyU5NCVCMSVFNCVCQSU4RSVFNyVBQiVBRiVFNSU4RiVBMyVFNCVCOCU4RCVFNSU5MCU4QyVFOCU4MCU4QyVFNCVCOCU4RCVFNSU5MCU4QyVFNiVCQSU5MCVFRiVCQyU4OSVFRiVCQyU5QQ==">http://localhost:8080/和http://localhost:8081由于端口不同而不同源）：<i class="fa fa-external-link-alt"></i></span><br><span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL3Rlc3QuaHRtbA==">http://localhost:8080/test.html<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;&lt;title&gt;test same origin policy&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;iframe id=“test” src=“http://localhost:8081/test2.html”&gt;&lt;/iframe&gt;</span><br><span class="line">        &lt;script type=“text/javascript”&gt;</span><br><span class="line">            document.getElementById(“test”).contentDocument.body.innerHTML = “write somthing”;</span><br><span class="line">        &lt;/script&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgxL3Rlc3QyLmh0bWw=">http://localhost:8081/test2.html<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;&lt;title&gt;test same origin policy&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        Testing.</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>在Firefox中会得到如下错误：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Error: Permission denied to access property ‘body’</span><br></pre></td></tr></table></figure>

<p>Document对象的domain属性存放着装载文档的服务器的主机名，可以设置它。<br>例如来自”blog.csdn.net”和来自”bbs.csdn.net”的页面，都将document.domain设置为”csdn.net”，则来自两个子域名的脚本即可相互访问。<br>出于安全的考虑，不能设置为其他主domain，比如 <span class="exturl" data-url="aHR0cDovL3d3dy5jc2RuLm5ldC8=">http://www.csdn.net/<i class="fa fa-external-link-alt"></i></span> 不能设置为sina.com</p>
<h2 id="Ajax跨域"><a href="#Ajax跨域" class="headerlink" title="Ajax跨域"></a>Ajax跨域</h2><p>Ajax (XMLHttpRequest)请求受到同源策略的限制。<br>Ajax通过XMLHttpRequest能够与远程的服务器进行信息交互，另外XMLHttpRequest是一个纯粹的javascript对象，这样的交互过程，是在后台进行的，用户不易察觉。<br>因此，XMLHTTP实际上已经突破了原有的javascript的安全限制。</p>
<p>举个例子：</p>
<p>假设某网站引用了其它站点的javascript，这个站点被compromise并在javascript中加入获取用户输入并通过ajax提交给其他站点，这样就可以源源不断收集信息。<br>或者某网站因为存在漏洞导致XSS注入了javascript脚本，这个脚本就可以通过ajax获取用户信息并通过ajax提交给其他站点，这样就可以源源不断收集信息。<br>如果我们又想利用XMLHTTP的无刷新异步交互能力，又不愿意公然突破javascript的安全策略，可以选择的方案就是给XMLHTTP加上严格的同源限制。<br>这样的安全策略，很类似于Applet的安全策略。IFrame的限制还仅仅是不能访问跨域HTMLDOM中的数据，而XMLHTTP则根本上限制了跨域请求的提交。（实际上下面提到了CORS已经放宽了限制）</p>
<p>随着Ajax技术和网络服务的发展，对跨域的要求也越来越强烈。下面介绍Ajax的跨域技术。</p>
<h3 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h3><p>JSONP技术实际和Ajax没有关系。我们知道<code>&lt;script&gt;</code>标签可以加载跨域的javascript脚本，并且被加载的脚本和当前文档属于同一个域。因此在文档中可以调用&#x2F;访问脚本中的数据和函数。如果javascript脚本中的数据是动态生成的，那么只要在文档中动态创建<code>&lt;script&gt;</code>标签就可以实现和服务端的数据交互。<br>JSONP就是利用<code>&lt;script&gt;</code>标签的跨域能力实现跨域数据的访问，请求动态生成的JavaScript脚本同时带一个callback函数名作为参数。其中callback函数本地文档的JavaScript函数，服务器端动态生成的脚本会产生数据，并在代码中以产生的数据为参数调用callback函数。当这段脚本加载到本地文档时，callback函数就被调用。</p>
<p>第一个站点的测试页面（<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL3Rlc3QuaHRtbCVFRiVCQyU4OSVFRiVCQyU5QQ==">http://localhost:8080/test.html）：<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=“http://localhost:8081/test_data.js”&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function test_handler(data) &#123;</span><br><span class="line">            console.log(data);</span><br><span class="line">        &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>服务器端的javascript脚本（<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgxL3Rlc3RfZGF0YS5qcyVFRiVCQyU4OSVFRiVCQyU5QQ==">http://localhost:8081/test_data.js）：<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test_handler(‘&#123;“data”: “something”&#125;’);</span><br></pre></td></tr></table></figure>
<p>为了动态实现JSONP请求，可以使用javascript动态插入<code>&lt;script&gt;</code>标签：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=“text/javascript”&gt;</span><br><span class="line">        // this shows dynamic script insertion</span><br><span class="line">        var script = document.createElement(‘script’);</span><br><span class="line">        script.setAttribute(‘src’, url);</span><br><span class="line">        // load the script</span><br><span class="line">        document.getElementsByTagName(‘head’)[0].appendChild(script);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>JSONP协议封装了上述步骤，jQuery中统一是现在AJAX中(其中data type为JSONP)：<br><span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL3Rlc3Q/Y2FsbGJhY2s9dGVzdF9oYW5kbGVy">http://localhost:8080/test?callback=test_handler<i class="fa fa-external-link-alt"></i></span></p>
<p>为了支持JSONP协议，服务器端必须提供特别的支持，另外JSONP只支持GET请求。</p>
<h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><p>使用代理方式跨域更加直接，因为SOP的限制是浏览器实现的。如果请求不是从浏览器发起的，就不存在跨域问题了。<br>使用本方法跨域步骤如下：</p>
<ol>
<li>把访问其它域的请求替换为本域的请求</li>
<li>本域的请求是服务器端的动态脚本负责转发实际的请求</li>
</ol>
<p>各种服务器的Reverse Proxy功能都可以非常方便的实现请求的转发，如Apache httpd + mod_proxy。<br>Eg.<br>为了通过Ajax从 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwLw==">http://localhost:8080<i class="fa fa-external-link-alt"></i></span> 访问 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgxL2FwaQ==">http://localhost:8081/api<i class="fa fa-external-link-alt"></i></span> ，可以将请求发往 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL2FwaQ==">http://localhost:8080/api<i class="fa fa-external-link-alt"></i></span> 。<br>然后利用Apache Web服务器的Reverse Proxy功能做如下配置：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ProxyPass /api http://localhost:8081/api</span><br></pre></td></tr></table></figure>

<h3 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h3><p>Cross origin resource sharing</p>
<blockquote>
<p>“Cross-origin resource sharing (CORS) is a mechanism that allows a web page to make XMLHttpRequests to another domain. Such “cross-domain” requests would otherwise be forbidden by web browsers, per the same origin security policy. CORS defines a way in which the browser and the server can interact to determine whether or not to allow the cross-origin request. It is more powerful than only allowing same-origin requests, but it is more secure than simply allowing all such cross-origin requests.” —-Wikipedia[3]</p>
</blockquote>
<p>通过在HTTP Header中加入扩展字段，服务器在相应网页头部加入字段表示允许访问的domain和HTTP method，客户端检查自己的域是否在允许列表中，决定是否处理响应。<br>实现的基础是JavaScript不能够操作HTTP Header。某些浏览器插件实际上是具有这个能力的。</p>
<p>服务器端在HTTP的响应头中加入（页面层次的控制模式）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Access-Control-Allow-Origin: example.com</span><br><span class="line">Access-Control-Request-Method: GET, POST</span><br><span class="line">Access-Control-Allow-Headers: Content-Type, Authorization, Accept, Range, Origin</span><br><span class="line">Access-Control-Expose-Headers: Content-Range</span><br><span class="line">Access-Control-Max-Age: 3600</span><br></pre></td></tr></table></figure>
<p>多个域名之间用逗号分隔，表示对所示域名提供跨域访问权限。<code>*</code>表示允许所有域名的跨域访问。</p>
<p>客户端可以有两种行为：</p>
<ol>
<li>发送OPTIONS请求，请求Access-Control信息。如果自己的域名在允许的访问列表中，则发送真正的请求，否则放弃请求发送。</li>
<li>直接发送请求，然后检查response的Access-Control信息，如果自己的域名在允许的访问列表中，则读取response body，否则放弃。<br>本质上服务端的response内容已经到达本地，JavaScript决定是否要去读取。</li>
</ol>
<p>Support: [Javascript Web Applications]</p>
<ul>
<li>IE &gt;&#x3D; 8 (需要安装caveat)</li>
<li>Firefox &gt;&#x3D; 3</li>
<li>Safari 完全支持</li>
<li>Chrome 完全支持</li>
<li>Opera 不支持</li>
</ul>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><p>测试页面 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgwL3Rlc3QzLmh0bWw=">http://localhost:8080/test3.html<i class="fa fa-external-link-alt"></i></span> 使用<code>jquery</code>发送Ajax请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">        &lt;head&gt;&lt;title&gt;testing cross sop&lt;/title&gt;&lt;/head&gt;</span><br><span class="line">        &lt;body&gt;</span><br><span class="line">            Testing.</span><br><span class="line">            &lt;script src=“jquery-2.0.0.min.js”&gt;&lt;/script&gt;</span><br><span class="line">            &lt;script type=‘text/javascript’&gt;</span><br><span class="line">                $.ajax(&#123;</span><br><span class="line">                    url: ‘http://localhost:8000/hello’,</span><br><span class="line">                    success: function(data) &#123;</span><br><span class="line">                        alert(data);</span><br><span class="line">                    &#125;,</span><br><span class="line">                    error: function() &#123;</span><br><span class="line">                        alert(‘error’);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &lt;/script&gt;</span><br><span class="line">        &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>测试Restful API(<span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDAwL2hlbGxvLyU3Qm5hbWUlN0Q=">http://localhost:8000/hello/{name}<i class="fa fa-external-link-alt"></i></span>) 使用<code>bottle.py</code>来host。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">from bottle import route, run, response</span><br><span class="line">@route(‘/hello’)</span><br><span class="line">def index():</span><br><span class="line">return ‘Hello World.’</span><br><span class="line">run(host=’localhost’, port=8000)</span><br></pre></td></tr></table></figure>

<h4 id="测试1："><a href="#测试1：" class="headerlink" title="测试1："></a>测试1：</h4><p>测试正常的跨域请求的行为。</p>
<p>测试结果：</p>
<ol>
<li>跨域GET请求已经发出，请求header中带有<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Origin    http://localhost:8080</span><br></pre></td></tr></table></figure></li>
<li>服务器端正确给出response</li>
<li>javascript拒绝读取数据，在firebug中发现reponse为空，并且触发error回调</li>
</ol>
<h4 id="测试2："><a href="#测试2：" class="headerlink" title="测试2："></a>测试2：</h4><p>测试支持CORS的服务器的跨域请求行为。<br>对Restful API做如下改动，在response中加入header：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">def index():</span><br><span class="line">#Add CORS header#</span><br><span class="line">response.set_header(“Access-Control-Allow-Origin”, “http://localhost:8080”)</span><br><span class="line">return ‘Hello World.’</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<ol>
<li>跨域GET请求已经发出，请求header中带有<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Origin    http://localhost:8080</span><br></pre></td></tr></table></figure></li>
<li>服务器端正确给出response</li>
<li>客户端正常获取数据</li>
</ol>
<h4 id="测试3："><a href="#测试3：" class="headerlink" title="测试3："></a>测试3：</h4><p>测试OPTIONS请求获取CORS信息。<br>对客户端的Ajax请求增加header：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">          url: ‘http://localhost:8000/hello’,</span><br><span class="line">          headers: &#123;‘Content-Type’: ‘text/html’&#125;,</span><br><span class="line">          success: function(data) &#123;</span><br><span class="line">              alert(data);</span><br><span class="line">          &#125;,</span><br><span class="line">          error: function() &#123;</span><br><span class="line">              alert(‘error’);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br></pre></td></tr></table></figure>
<p>对Restful API做如下改动：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@route(‘/hello’, method = [‘OPTIONS’, ‘GET’])</span><br><span class="line">def index():</span><br><span class="line">if request.method == ‘OPTIONS’:</span><br><span class="line">return ”</span><br><span class="line">return ‘Hello World.’</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<ol>
<li>Ajax函数会首先发送OPTIONS请求</li>
<li>针对OPTIONS请求服务器</li>
<li>客户端发现没有CORS header后不会发送GET请求</li>
</ol>
<h4 id="测试4："><a href="#测试4：" class="headerlink" title="测试4："></a>测试4：</h4><p>增加服务器端对OPTIONS方法的处理。<br>对Restful API做如下改动：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">@route(‘/hello’, method = [‘OPTIONS’, ‘GET’])</span><br><span class="line">def index():</span><br><span class="line">response.headers[‘Access-Control-Allow-Origin’] = ‘http://localhost:8080’</span><br><span class="line">response.headers[‘Access-Control-Allow-Methods’] = ‘GET, OPTIONS’</span><br><span class="line">response.headers[‘Access-Control-Allow-Headers’] = ‘Origin, Accept, Content-Type’</span><br><span class="line">if request.method == ‘OPTIONS’:</span><br><span class="line">return ”</span><br><span class="line">return ‘Hello World.’</span><br></pre></td></tr></table></figure>

<p>测试结果：</p>
<ol>
<li>Ajax函数会首先发送OPTIONS请求</li>
<li>针对OPTIONS请求服务器</li>
<li>客户端匹配CORS header中的allow headers and orgin后会正确发送GET请求并获取结果<br>测试发现，<code>Access-Control-Allow-Headers</code>是必须的。</li>
</ol>
<p>CORS协议提升了Ajax的跨域能力，但也增加了风险。一旦网站被注入脚本或XSS攻击，将非常方便的获取用户信息并悄悄传递出去。</p>
<h2 id="Cookie-同源策略"><a href="#Cookie-同源策略" class="headerlink" title="Cookie 同源策略"></a>Cookie 同源策略</h2><p>Cookie中的同源只关注域名，忽略协议和端口。所以 <span class="exturl" data-url="aHR0cHM6Ly9sb2NhbGhvc3Q6ODA4MC8=">https://localhost:8080/<i class="fa fa-external-link-alt"></i></span> 和 <span class="exturl" data-url="aHR0cDovL2xvY2FsaG9zdDo4MDgxLw==">http://localhost:8081/<i class="fa fa-external-link-alt"></i></span> 的Cookie是共享的。</p>
<h2 id="Flash-x2F-SilverLight跨域"><a href="#Flash-x2F-SilverLight跨域" class="headerlink" title="Flash&#x2F;SilverLight跨域"></a>Flash&#x2F;SilverLight跨域</h2><p>浏览器的各种插件也存在跨域需求。通常是通过在服务器配置<code>crossdomain.xml</code>，设置本服务允许哪些域名的跨域访问。<br>客户端会首先请求此文件，如果发现自己的域名在访问列表里，就发起真正的请求，否则不发送请求。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=”1.0″?&gt;</span><br><span class="line">&lt;!DOCTYPE cross-domain-policy SYSTEM “http://www.macromedia.com/xml/dtds/cross-domain-policy.dtd”&gt;</span><br><span class="line">&lt;cross-domain-policy&gt;</span><br><span class="line">&lt;allow-access-from domain=”*”/&gt;</span><br><span class="line">&lt;allow-http-request-headers-from domain=”*” headers=”*”/&gt;</span><br><span class="line">&lt;/cross-domain-policy&gt;</span><br></pre></td></tr></table></figure>

<p>通常<code>crossdomain.xml</code>放置在网站根目录。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>互联网的发展催生了跨域访问的需求，各种跨域方法和协议满足了需求但也增加了各种风险。尤其是XSS和CSRF等攻击的盛行也得益于此。<br>了解这些技术背景有助于在实际项目中熟练应用并规避各种安全风险。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p>[1] 白帽子讲Web安全: <span class="exturl" data-url="aHR0cDovL2Jvb2suZG91YmFuLmNvbS9zdWJqZWN0LzEwNTQ2OTI1Lw==">http://book.douban.com/subject/10546925/<i class="fa fa-external-link-alt"></i></span><br>[2] 使用 JSONP 实现跨域通信: <span class="exturl" data-url="aHR0cDovL3d3dy5pYm0uY29tL2RldmVsb3BlcndvcmtzL2NuL3dlYi93YS1hai1qc29ucDEv">http://www.ibm.com/developerworks/cn/web/wa-aj-jsonp1/<i class="fa fa-external-link-alt"></i></span><br>[3] Cross-origin resource sharing: <span class="exturl" data-url="aHR0cDovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9Dcm9zcy1PcmlnaW5fUmVzb3VyY2VfU2hhcmluZw==">http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing<i class="fa fa-external-link-alt"></i></span><br>[4] Cross-domain policy for Flash movies: <span class="exturl" data-url="aHR0cDovL2tiMi5hZG9iZS5jb20vY3BzLzE0Mi90bl8xNDIxMy5odG1s">http://kb2.adobe.com/cps/142/tn_14213.html<i class="fa fa-external-link-alt"></i></span></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN,en,default">
    <link itemprop="mainEntityOfPage" href="https://yaozihao.com/js_nginx_node/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zihao Yao">
      <meta itemprop="description" content="由渐入深，记录程序人生。全栈工程师与你共勉。">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Zihao">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/js_nginx_node/" class="post-title-link" itemprop="url">Nginx与Node.js结合使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-02-16 15:30:11" itemprop="dateCreated datePublished" datetime="2017-02-16T15:30:11Z">2017-02-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-11-24 05:24:10" itemprop="dateModified" datetime="2022-11-24T05:24:10Z">2022-11-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>3.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Node.js是一个基于Chrome JavaScript运行时建立的平台， 用于方便地搭建响应速度快、易于扩展的网络应用。Node.js 使用事件驱动， 非阻塞I&#x2F;O 模型而得以轻量和高效，非常适合在分布式设备上运行的数据密集型的实时应用，如实时聊天等等。然而对于gzip编码，静态文件，HTTP缓存，SSL处理，负载平衡和反向代理等，都可以通过nginx来完成，从而减小node.js的负载，并通过nginx强大的缓存来节省网站的流量从而提高网站的加载速度。</p>
<p>nginx配置如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    proxy_cache_path  /var/cache/nginx levels=1:2 keys_zone=one:8m max_size=3000m inactive=600m;</span><br><span class="line">    proxy_temp_path /var/tmp;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet–stream;</span><br><span class="line">    sendfile        on;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_comp_level 6;</span><br><span class="line">    gzip_vary on;</span><br><span class="line">    gzip_min_length  1000;</span><br><span class="line">    gzip_proxied any;</span><br><span class="line">    gzip_types text/plain text/html text/css application/json application/x–javascript text/xml application/xml application/xml+rss text/javascript;</span><br><span class="line">    gzip_buffers 16 8k;</span><br><span class="line">    ssl_certificate /some/location/sillyfacesociety.com.bundle.crt;</span><br><span class="line">    ssl_certificate_key /some/location/sillyfacesociety.com.key;</span><br><span class="line">    ssl_protocols        SSLv3 TLSv1;</span><br><span class="line">    ssl_ciphers HIGH:!aNULL:!MD5;</span><br><span class="line">    upstream silly_face_society_upstream &#123;</span><br><span class="line">      server 127.0.0.1:61337;</span><br><span class="line">      server 127.0.0.1:61338;</span><br><span class="line">      keepalive 64;</span><br><span class="line">    &#125;</span><br><span class="line">    server &#123;</span><br><span class="line">      listen 80;</span><br><span class="line">      listen 443 ssl;</span><br><span class="line">      server_name sillyfacesociety.com;</span><br><span class="line">      return 301 $scheme://www.sillyfacesociety.com$request_uri;</span><br><span class="line">    &#125;</span><br><span class="line">    server &#123;</span><br><span class="line">        listen 80;</span><br><span class="line">        listen 443 ssl;</span><br><span class="line">        server_name www.sillyfacesociety.com;</span><br><span class="line">        error_page 502  /errors/502.html;</span><br><span class="line">        location ~ ^/(images/|img/|javascript/|js/|css/|stylesheets/|flash/|media/|static/|robots.txt|humans.txt|favicon.ico) &#123;</span><br><span class="line">          root /usr/local/silly_face_society/node/public;</span><br><span class="line">          access_log off;</span><br><span class="line">          expires max;</span><br><span class="line">        &#125;</span><br><span class="line">        location /errors &#123;</span><br><span class="line">          internal;</span><br><span class="line">          alias /usr/local/silly_face_society/node/public/errors;</span><br><span class="line">        &#125;</span><br><span class="line">        location / &#123;</span><br><span class="line">          proxy_redirect off;</span><br><span class="line">          proxy_set_header   X–Real–IP            $remote_addr;</span><br><span class="line">          proxy_set_header   X–Forwarded–For  $proxy_add_x_forwarded_for;</span><br><span class="line">          proxy_set_header   X–Forwarded–Proto $scheme;</span><br><span class="line">          proxy_set_header   Host                   $http_host;</span><br><span class="line">          proxy_set_header   X–NginX–Proxy    true;</span><br><span class="line">          proxy_set_header   Connection “”;</span><br><span class="line">          proxy_http_version 1.1;</span><br><span class="line">          proxy_cache one;</span><br><span class="line">          proxy_cache_key sfs$request_uri$scheme;</span><br><span class="line">          proxy_pass         http://silly_face_society_upstream;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>配置段说明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    upstream silly_face_society_upstream &#123;</span><br><span class="line">      server 127.0.0.1:61337;</span><br><span class="line">      server 127.0.0.1:61338;</span><br><span class="line">      keepalive 64;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>nginx负载均衡多个nodo.js实例。keepalive 64 指示nginx在任何时候保持最少64个HTTP&#x2F; 1.1连接到代理服务器。如果有更多的流量nginx将打开更多的连接。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    server &#123;</span><br><span class="line">        ...</span><br><span class="line">        location / &#123;</span><br><span class="line">          proxy_redirect off;</span><br><span class="line">          proxy_set_header   X–Real–IP            $remote_addr;</span><br><span class="line">          proxy_set_header   X–Forwarded–For  $proxy_add_x_forwarded_for;</span><br><span class="line">          proxy_set_header   Host                   $http_host;</span><br><span class="line">          proxy_set_header   X–NginX–Proxy    true;</span><br><span class="line">          ...</span><br><span class="line">          proxy_set_header   Connection “”;</span><br><span class="line">          proxy_http_version 1.1;</span><br><span class="line">          proxy_pass         http://silly_face_society_upstream;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>将符合哪些的请求发送到代理上。nginx的匹配规则可以取看看前面的文章。</p>
<p>nginx处理静态内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    server &#123;</span><br><span class="line">        ...</span><br><span class="line">        location ~ ^/(images/|img/|javascript/|js/|css/|stylesheets/|flash/|media/|static/|robots.txt|humans.txt|favicon.ico) &#123;</span><br><span class="line">          root /usr/local/silly_face_society/node/public;</span><br><span class="line">          access_log off;</span><br><span class="line">          expires max;</span><br><span class="line">        &#125;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设置缓存</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    ...</span><br><span class="line">    proxy_cache_path  /var/cache/nginx levels=1:2 keys_zone=one:8m max_size=3000m inactive=600m;</span><br><span class="line">    proxy_temp_path /var/tmp;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line">http &#123;</span><br><span class="line">  server &#123;</span><br><span class="line">     ...</span><br><span class="line">     location / &#123;</span><br><span class="line">          ...</span><br><span class="line">          proxy_cache one;</span><br><span class="line">          proxy_cache_key sfs$request_uri$scheme;</span><br><span class="line">          ...</span><br><span class="line">     &#125;</span><br><span class="line">     ...</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>缓存是通过HTTP头部来控制的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/20/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><span class="page-number current">21</span><a class="page-number" href="/page/22/">22</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/22/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Zihao Yao</p>
  <div class="site-description" itemprop="description">由渐入深，记录程序人生。全栈工程师与你共勉。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">278</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">64</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3VjZnlhbw==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ucfyao"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOnVjZnlhb0BnbWFpbC5jb20=" title="E-Mail → mailto:ucfyao@gmail.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9iaWRpbmd0b3U=" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;bidingtou"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <span class="exturl" data-url="aHR0cHM6Ly93d3cuYmFpZHUuY29tLw==" title="https:&#x2F;&#x2F;www.baidu.com&#x2F;">baidu</span>
        </li>
        <li class="links-of-blogroll-item">
          <span class="exturl" data-url="aHR0cHM6Ly93d3cuZ29vZ2xlLmNvbS8=" title="https:&#x2F;&#x2F;www.google.com&#x2F;">google</span>
        </li>
    </ul>
  </div>

      </div>


    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zihao Yao</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">796k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">12:04</span>
</div>

        
<div class="busuanzi-count">
  <script data-pjax async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  
  <script data-pjax>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













    <div id="pjax">
  

  

  
  <script src="//cdn.jsdelivr.net/npm/quicklink@1/dist/quicklink.umd.js"></script>
  <script>
      window.addEventListener('load', () => {
      quicklink({
        timeout : 3000,
        priority: true,
        ignores : [uri => uri.includes('#'),uri => uri === 'https://yaozihao.com/page/21/',]
      });
      });
  </script>

    </div>
</body>
</html>
